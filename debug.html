<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Debug - Clear Session</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        .btn {
            padding: 15px 30px;
            margin: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        .btn-primary {
            background: #007bff;
            color: white;
        }
        .btn-success {
            background: #28a745;
            color: white;
        }
        .info {
            margin: 20px 0;
            padding: 15px;
            background: #e9ecef;
            border-radius: 5px;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ”§ Admin Debug Tool</h1>
        <p>This page helps resolve login loop issues by clearing conflicting session data.</p>
        
        <div class="info">
            <h3>Current localStorage Data:</h3>
            <div id="storageInfo"></div>
        </div>
        
        <button class="btn btn-danger" onclick="clearAllAdminData()">
            Clear All Admin Data
        </button>
        
        <button class="btn btn-primary" onclick="checkAdminData()">
            Check Current Data
        </button>
        
        <button class="btn btn-success" onclick="goToLogin()">
            Go to Admin Login
        </button>
        
        <div id="message" style="margin-top: 20px; padding: 10px; display: none;"></div>
    </div>

    <script>
        function checkAdminData() {
            const storageInfo = document.getElementById('storageInfo');
            const adminSession = localStorage.getItem('adminSession');
            const adminUsername = localStorage.getItem('adminUsername');
            const oldAdminSession = localStorage.getItem('admin_session');
            
            storageInfo.innerHTML = `
                <strong>adminSession:</strong> ${adminSession || 'Not set'}<br>
                <strong>adminUsername:</strong> ${adminUsername || 'Not set'}<br>
                <strong>admin_session (old):</strong> ${oldAdminSession || 'Not set'}<br>
                <hr>
                <small>Total localStorage items: ${localStorage.length}</small>
            `;
        }
        
        function clearAllAdminData() {
            // Clear all admin-related localStorage
            localStorage.removeItem('adminSession');
            localStorage.removeItem('adminUsername');
            localStorage.removeItem('admin_session');
            
            const message = document.getElementById('message');
            message.textContent = 'âœ… All admin session data cleared successfully!';
            message.style.display = 'block';
            message.style.background = '#d4edda';
            message.style.color = '#155724';
            message.style.borderRadius = '5px';
            
            checkAdminData();
            
            setTimeout(() => {
                message.style.display = 'none';
            }, 3000);
        }
        
        function goToLogin() {
            window.location.href = '/admin-login.html';
        }
        
        // Check data on page load
        window.addEventListener('DOMContentLoaded', checkAdminData);
    </script>
</body>
</html>
        <p><strong>Current URL:</strong> <span id="current-url"></span></p>
    </div>

    <div class="debug-info">
        <h3>Cart Test:</h3>
        <button onclick="testAddToCart()">Add Test Item to Cart</button>
        <button onclick="showCart()">Show Cart Contents</button>
        <button onclick="clearCart()">Clear Cart</button>
        <button onclick="testWhatsApp()">Test WhatsApp</button>
    </div>

    <div class="debug-info">
        <h3>Debug Output:</h3>
        <div id="debug-output"></div>
    </div>

    <script>
        // Fill in debug info
        document.getElementById('user-agent').textContent = navigator.userAgent;
        document.getElementById('is-mobile').textContent = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        document.getElementById('storage-available').textContent = typeof Storage !== "undefined";
        document.getElementById('current-url').textContent = window.location.href;

        function debugLog(message) {
            const output = document.getElementById('debug-output');
            output.innerHTML += '<p>' + new Date().toLocaleTimeString() + ': ' + message + '</p>';
            console.log(message);
        }

        function testAddToCart() {
            try {
                debugLog('Testing add to cart...');
                const cart = JSON.parse(localStorage.getItem("cart")) || [];
                const testProduct = {
                    name: "Test Product",
                    price: 100,
                    image: "/products/test.jpg",
                    quantity: 1
                };
                cart.push(testProduct);
                localStorage.setItem("cart", JSON.stringify(cart));
                debugLog('Test product added successfully');
            } catch (error) {
                debugLog('Error adding to cart: ' + error.message);
            }
        }

        function showCart() {
            try {
                const cart = JSON.parse(localStorage.getItem("cart")) || [];
                debugLog('Cart contents: ' + JSON.stringify(cart, null, 2));
            } catch (error) {
                debugLog('Error reading cart: ' + error.message);
            }
        }

        function clearCart() {
            try {
                localStorage.removeItem("cart");
                debugLog('Cart cleared');
            } catch (error) {
                debugLog('Error clearing cart: ' + error.message);
            }
        }

        function testWhatsApp() {
            try {
                const message = "Test message from debug page";
                const whatsappNumber = "916200835077";
                const encodedMessage = encodeURIComponent(message);
                const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
                debugLog('Opening WhatsApp: ' + whatsappURL);
                window.open(whatsappURL, "_blank");
            } catch (error) {
                debugLog('Error with WhatsApp: ' + error.message);
            }
        }

        debugLog('Debug page loaded successfully');
    </script>
</body>
</html>